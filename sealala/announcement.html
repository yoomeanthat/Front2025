<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>씨랄라 워터파크 쉬는시간 방송</title>
  <style>
    .image_box {

      position: absolute;
      top: 0px;
      left: 0px;

      width: 150px;
      height: 50px;

      background-image: url('./images/sealalamark.png');
      background-size: contain;
      background-repeat: no-repeat;
      image-rendering: auto;
      /* 부드러운 렌더링 */
    }

    .top {
      position: relative;
      height: 150px;
      background-color: wheat;

      color: darkgoldenrod;
      text-align: center;
      line-height: 150px;
      font-size: 40px;
      font-weight: bold;
    }

    .top button {
      width: 200px;
      height: 50px;
      position: absolute;
      top: 50px;
      left: 0px;
    }

    .top button:hover {
      box-shadow: 0px 0px 10px 10px rgb(83, 173, 106);
    }

    .middle {
      height: 500px;
      display: flex;
    }

    .middle button {
      width: 170px;
      height: 50px;
      border-radius: 50px;
      font-weight: bold;
      margin-top: 50px;

      cursor: pointer;

      transition: transform 0.5s ease;
    }

    .middle button:hover {
      transform: rotate(360deg);
      box-shadow: 0px 0px 10px 10px rgb(83, 173, 106);
    }

    #custom-alert {
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      background-color: #ffeb3b;
      color: #333;
      padding: 16px 24px;
      border-radius: 8px;
      font-weight: bold;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      z-index: 9999;
      display: none;
      font-family: sans-serif;
    }

    textarea {
      margin: 20px;
      padding: 10px;
      font-size: 16px;
      font-family: sans-serif;
    }
  </style>

  <script src="https://www.youtube.com/iframe_api"></script>
</head>



<body>

  <iframe id="youtube-player" src="https://www.youtube.com/embed/7hLqc_-NE7s?enablejsapi=1" frameborder="0"
    allow="autoplay" allowfullscreen>
  </iframe>


  <!-- header -->
  <div class="top">씨랄라 워터파크 방송 시스템
    <div class="image_box"></div>
    <div id="custom-alert"></div>
    <button onclick="movePage()">씨랄라 홈페이지로 이동</button>
  </div>

  <!-- 특이사항 칸과  -->
  <div class="middle">
    <textarea cols="50" rows="20" placeholder="특이사항 적어두기 &#10; ex) 비워야할 쓰레기통,  &#10; 금일의 음주계획&#10;"></textarea>
    <button onclick="warning()">😘윤배 사진 보러가기😘</button>
    <button onclick="moveGame()">가위바위보 게임</button>
  </div>




  <script>

    let player;
    function onYouTubeIframeAPIReady() {
      player = new YT.Player('youtube-player');
    }

    function muteYouTube() {
      if (player && typeof player.mute === 'function') {
        player.mute();
      }
    }

    //방송 알림 메서드
    function showAlert(message) {
      const alertBox = document.getElementById('custom-alert');
      alertBox.textContent = message;
      alertBox.style.display = 'block';

      setTimeout(() => {
        alertBox.style.display = 'none';
      }, 3000); // 3초 뒤 숨기기
    }


    document.body.addEventListener('ended', () => {
      const audio = new Audio('./musics/breaktime.mp3');
      audio.play();
    });




    //방송 나오는 메서드 & 오류시 메세지
    function playSound(src, onEndedCallback) {
      const audio = new Audio(src);

      // 유튜브 영상 일시정지
      if (player && typeof player.pauseVideo === 'function') {
        player.pauseVideo();
      }

      audio.play()
        .then(() => {
          const now = new Date();
          const hours = now.getHours();
          const minutes = now.getMinutes();
          const seconds = now.getSeconds();
          console.log(`🕒 쉬는 시간 방송 시작 시각 → ${hours}시 ${minutes}분 ${seconds}초`);

          // 오디오 끝났을 때 유튜브 다시 재생
          audio.addEventListener('ended', () => {
            if (player && typeof player.playVideo === 'function') {
              player.playVideo();
            }

            if (onEndedCallback) {
              onEndedCallback();
            }
          });

        })
        .catch(e => console.error("오디오 재생 오류: 직접 실행하시오", e));
    }


    //시간 확인 메서드 (UTC+9 동경 135도 도쿄시 사용)
    function checkAndPlaySound() {
      const now = new Date();
      const hours = now.getHours();
      const minutes = now.getMinutes();
      const seconds = now.getSeconds();

      //10시 방송
      if (minutes === 36 && seconds === 0 && hours === 2) {
        showAlert("쉬는 시간 시작!!");
        playSound('musics/breaktime.mp3', () => { });
      }

      //11~16시 방송
      if (minutes === 47 && seconds === 0 && hours >= 11 && hours <= 16) {
        showAlert("쉬는 시간 시작!!");
        playSound('musics/breaktime.mp3', () => {
        });
      }


      //17시 쉬는 시간 방송 이후 마감 전 방송 (쉬는 시간 방송 이후 호루라기 불 시간 6초가 있음)
      if (minutes === 47 && seconds === 0 && hours === 17) {
        showAlert("쉬는 시간 시작!!");
        playSound('musics/breaktime.mp3', () => {
        });

      } else if (minutes === 47 && seconds === 35 && hours === 17) {
        showAlert("마감 전 방송 시작!!");
        playSound('musics/lastbreaktime.mp3');
        console.log(`🕒 마감전 방송 시작 시각 → ${hours}시 ${minutes}분 ${seconds}초`);
      }

      // 마감 방송(18시)
      if (minutes === 37 && seconds === 0 && hours === 18) {
        showAlert("이젠안녕 시작!!");
        playSound('musics/goodbye.mp3', () => {
        });

      } else if (minutes === 41 && seconds === 45 && hours === 18) {
        showAlert("하이라이트 시작!!");
        playSound('musics/highlight.mp3');
        console.log(`🕒 하이라이트 방송 시작 시각 → ${hours}시 ${minutes}분 ${seconds}초`);
      }
    }

    setInterval(checkAndPlaySound, 1000);


    //갤러리 이동 경고 메서드
    function warning() {
      const result = confirm("🥵🥵아는 사람의 나체를 볼수도 있습니다 계속 하시겠습니까?🥵🥵");
      if (result) {
        // 새 탭으로 이동
        window.open("./gallerycopy.html", "_blank");
      } else {
        alert("훌륭한 선택입니다");
      }
    }

    function moveGame() {
      window.open("./rspgame.html", "_blank");
    }


    //홈페이지 이동 메서드
    function movePage() {
      alert("홈페이지로 이동합니다");
      window.open("http://www.sealala.com/", "_blank");
    }

  </script>
</body>

</html>